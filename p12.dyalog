⎕PP←34 ⋄ p←(1 4 3⍴0)⍪↑{⍎¨⍵(∊⊆⊣)⎕D,'-'}¨⊃⎕NGET'p12.txt'1
f←{v pos←⊂⍤¯1⊢⍵ ⋄ (↑,⊂v+pos)⍪⍨v←v+↑+/∘.(<+¯1×>)⍨⊂⍤¯1⊢pos}
+/×⌿+/|f⍣1000⊢p ⍝ part 1
∧/{i c←⍵ 1 ⋄ c⊣{f⍵⊣c+←1}⍣{⍺≡i}⊢f⍵}∘⍉⍤2⍉p ⍝ part 2
