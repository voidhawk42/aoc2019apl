i←(⊂'ORE'),⍨⊃,/¯1↑¨o←{⍵(∊⊆⊣)⎕A}¨p←⊃⎕NGET'p14.txt'1
r←↑{(-@(⍳¯1+≢⍺)⊢⍎¨⍺)@(i⍳⍵)⊢0⍴⍨≢i}/({⍵(∊⊆⊣)⎕D}¨p),⍪o
f←{c←⍵×r⌷⍨i⍳⊂'FUEL' ⋄ ¯1↑-c⊣{c+←(a⌷r)×⌈(-a⌷c)÷r⌷⍨2⍴a←⊃⍸0>c}⍣{∧/0≤¯1↓c}⊢0}
f 1 ⍝ part 1
u←{1e12<f⍵:⍵ ⋄ ∇2×⍵}1 ⋄ 1{⍺=⍵:⍵ ⋄ 1e12>f⊢m←⌈2÷⍨⍺+⍵:m∇⍵-1 ⋄ ⍺∇m}u ⍝ part 2